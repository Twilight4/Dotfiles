#+title: Doom Emacs Keybinds Cheatsheet

This documentation provides cheat sheet for which presents keybindings for my emacs configuration which is designed for potentiality to achieve enhanced productivity while minimizing the need for excessive and complex key combinations. The primary objective is to streamline the user experience, by minimizing the need for excessive key combinations and utilizing those that are often overlooked or unutilized by default. The philosophy adopted in this configuration prioritizes simplicity and ease of use. The aim is to minimize the number of key combinations required to perform frequently used actions, thereby reducing cognitive load and improving overall efficiency and productivity.

* Table of Contents :toc:
- [[#essential-keybindings][Essential Keybindings]]
  - [[#help-pages][Help pages]]
- [[#navigation][Navigation]]
  - [[#buffer-management][Buffer Management]]
  - [[#window-management][Window Management]]
  - [[#workspace-management][Workspace Management]]
  - [[#bookmark-management][Bookmark Management]]
  - [[#ibuffer-mode][Ibuffer mode]]
  - [[#perspective][Perspective]]
  - [[#registers][Registers]]
- [[#file-search][File Search]]
  - [[#general-file-search][General file search]]
  - [[#open-specific-files][Open specific files]]
- [[#line-settings][Line settings]]
- [[#org-mode][Org Mode]]
  - [[#org-mode-basics][Org mode basics]]
  - [[#org-roam][Org-Roam]]
  - [[#task-management][Task Management]]
  - [[#style-formatting-visual-mode][Style formatting (visual mode)]]
  - [[#tables][Tables]]
- [[#packages][Packages]]
  - [[#magit][Magit]]
  - [[#evil-snipe][Evil-Snipe]]
  - [[#treemacs][Treemacs]]
- [[#system-config-and-setup-on-wayland][System config and setup on Wayland]]
  - [[#setup-on-hyprland-wm][Setup on Hyprland WM]]
  - [[#mime-types][Mime types]]
  - [[#git-diffs][Git diffs]]
  - [[#literate-programming][Literate programming]]

* Essential Keybindings
| KEYBINDING | DESCRIPTION           |
|------------+-----------------------|
| SPC .      | Create or find file   |
| SPC f s    | Save the current file |
| SPC f D    | Delete this file      |
| SPC h r r  | Reload emacs          |
| SPC q q    | Close emacs           |
| SPC h t    | Change theme          |
| SPC h d h  | Open documentation    |

** Help pages
| KEYBINDING | DESCRIPTION                                                |
|------------+------------------------------------------------------------|
| SPC h k    | tells you how key combinations translate to Emacs commands |
| SPC h w    | helps you find keyboard shortcuts for different commands   |
| SPC h v    | lets you see whatâ€™s inside variables and change them       |
| SPC h f    | tells you about functions and where they are define        |

* TODO Navigation
** TODO Buffer Management
| KEYBINDING | DESCRIPTION                 |
|------------+-----------------------------|
| SPC b b    | Open another buffer         |
| SPC ,      | Switch to buffer            |
| SPC b B    | See all buffers             |
| SPC S-,    | Switch and show all buffers |
| SPC b X    | Create a scratch buffer     |
| SPC b s    | Save a buffer and name it   |
| SPC b p    | Buffer previous             |
| SPC b n    | Buffer next                 |

** TODO Window Management
| KEYBINDING  | DESCRIPTION                        |
|-------------+------------------------------------|
| C-S-n       | Split window vertically            |
| SPC w s     | Split window horizontally          |
| C-h/k/l     | Switch to window (C-j is new line) |
| SPC C-h/k/l | Move window left/down/up/right     |
| C-S-w       | Close window                       |
| resize mode | Enter resize mode                  |

** TODO Workspace Management
| KEYBINDING | DESCRIPTION                 |
|------------+-----------------------------|
| C-t        | New workspace               |
| SPC TAB N  | New workspace and name it   |
| SPC TAB [  | Previous workspace          |
| SPC TAB ]  | Next workspace              |
| SPC TAB d  | Remove workspace            |
| SPC TAB R  | Restore last session        |
| M-1/2/3/4  | Switch to workspace 1/2/3/4 |

** Bookmark Management
| KEYBINDING | DESCRIPTION                            |
|------------+----------------------------------------|
| SPC b L    | List bookmarks                         |
| SPC b m    | Set bookmark                           |
| SPC b M    | Delete bookmark                        |
| SPC b w    | Save current bookmark to bookmark file |

** Ibuffer mode
| KEYBINDING | DESCRIPTION                            |
|------------+----------------------------------------|
| m          | Mark the buffer                        |
| u          | Unmark the buffer                      |
| x          | Kill the marked buffers                |
| f c        | Ibuffer filter by content              |
| f d        | Ibuffer filter by directory            |
| f f        | Ibuffer filter by filename (full path) |
| f m        | Ibuffer filter by mode                 |
| f n        | Ibuffer filter by name                 |
| f x        | Disable ibuffer filter                 |
| g h        | Hide marked buffers                    |
| g H        | Restore hidden buffers                 |

** Perspective
| KEYBINDING | DESCRIPTION                         |
|------------+-------------------------------------|
| SPC DEL    | Switch to perspective NAME          |
| SPC ,      | Switch to buffer in perspective     |
| SPC ]      | Switch to next perspective          |
| SPC [      | Switch to previous perspective      |
| SPC +      | Add a buffer to current perspective |
| SPC -      | Remove perspective by name          |
| SPC 0-9    | Switch to workspace n               |

** Registers
| KEYBINDING | DESCRIPTION                      |
|------------+----------------------------------|
| SPC r c    | Copy to register                 |
| SPC r f    | Frameset to register             |
| SPC r i    | Insert contents of register      |
| SPC r j    | Jump to register                 |
| SPC r l    | List registers                   |
| SPC r n    | Number to register               |
| SPC r r    | Interactively choose a register  |
| SPC r v    | View a register                  |
| SPC r w    | Window configuration to register |
| SPC r +    | Increment register               |
| SPC r SPC  | Point to register                |

* TODO File Search
** General file search
| KEYBINDING | DESCRIPTION                         |
|------------+-------------------------------------|
| SPC .      | Create or find file                 |
| SPC f r    | Recently opened files               |
| SPC p r    | Recently visited files in a project |
| SPC p p    | Open a project                      |
| SPC SPC    | Open a file in a project            |

** TODO Open specific files
| KEYBINDING | DESCRIPTION            |
|------------+------------------------|
| SPC f p    | Open config directory  |
| SPC = r    | Edit repeaters.org     |
| SPC = a    | Edit agenda file       |
| SPC = c    | Edit doom config.org   |
| SPC = s    | Edit emacs cheatsheet  |
| SPC = i    | Edit inbox.org         |
| SPC = p    | Edit doom projects.org |

* Line settings
| KEYBINDING  | DESCRIPTION                               |
|-------------+-------------------------------------------|
| SPC TAB TAB | Comment or uncomment lines                |
| SPC t h     | Toggle line highlighting in current frame |
| SPC t H     | Toggle line highlighting globally         |
| SPC t l     | Toggle line numbers                       |
| SPC t t     | Toggle truncate lines                     |

* TODO Org Mode
** Org mode basics
| KEYBINDING | DESCRIPTION                                        |
|------------+----------------------------------------------------|
| SPC n      | Prefix for org keybinding                          |
| SPC m h    | toggle heading                                     |
| SPC m i    | toggle item                                        |
| C-Ret      | Create a headline of the same type                 |
| C-S-Ret    | Create a headline of the same type above           |
| M-Ret      | Create a headline of the same type (from anywhere) |
| C-M-Ret    | Create another level headline (from anywhere)      |
| TAB/S-TAB  | Toggle folding/cycle through folded stages         |
| M-h/j/k/l  | Promotes/demotes/up/down header                    |
| SPC b o    | Create new empty Org buffer                        |
| g h/j/k/l  | Backward/forward/up/down heading                   |

** TODO Org-Roam
| KEYBINDING | DESCRIPTION                        |
|------------+------------------------------------|
| SPC n r f  | Create/find new node               |
| SPC n r i  | Insert link to other node          |
| SPC n r r  | Toggle roam buffers                |
| SPC n r c  | Completion of node-insert at point |
| SPC n r g  | Show graph of all nodes            |
| SPC n r n  | Capture to node                    |

** TODO Task Management

*** TODO Lists

*** TODO Checkboxes

*** TODO Links and hyperlinks
- You can add =::= to specify a heading or a line number
- You can paste http links as well

| KEYBINDING | DESCRIPTION               |
|------------+---------------------------|
| SPC m l    | Add a link to an org page |
| SPC m l f  | Insert file link          |

** Style formatting (visual mode)
| KEYBINDING | DESCRIPTION |
|------------+-------------|
| m          | Bold        |
| /          | Italic      |
| .          | Green color |

** Tables
- To start a table just start typing: =| table | name | description=

| KEYBINDING          | DESCRIPTION                                   |
|---------------------+-----------------------------------------------|
| TAB/S-Tab           | Forward/backward                              |
| SPC m b -           | Make org table headline                       |
| S-Ret               | Duplicate a field in the call below           |
| C-Ret (normal mode) | Create new table below                        |
| Ret (normal mode)   | Clear the field and enter insert mode         |
| M-h/j/k/l           | The same essential keybindings for navigation |
| M-S-j/k             | Insert a new row above/delete current row     |
| o                   | Insert new roam and move to the beginning     |

* TODO Packages
** TODO Magit
** TODO Evil-Snipe
*** TODO Inline navigation

*** TODO Long distance navigation
** TODO Treemacs
| KEYBINDING | DESCRIPTION       |
|------------+-------------------|
| SPC o p    | Toggle on and off |

* TODO System config and setup on Wayland
- Reload emacs every time you alter =init.el=, =packages.el= or =config.el= - =SPC h r r=

** Setup on Hyprland WM
1. Install bare emacs package: =yay -S emacs-gcc-wayland-devel-bin=
2. Run the installer script
   #+begin_src bash
    git clone --depth 1 https://github.com/doomemacs/doomemacs ~/.config/emacs
    ~/.config/emacs/bin/doom install
    #+end_src
3. Add aliases for doom bins and for launching emacs
   #+begin_src bash
    alias doomsync="~/.config/emacs/bin/doom sync"
    alias doomdoctor="~/.config/emacs/bin/doom doctor"
    alias doomupgrade="~/.config/emacs/bin/doom upgrade"
    alias doompurge="~/.config/emacs/bin/doom purge"
    alias emacs="emacsclient -c -a emacs"
   #+end_src
4. Add =blurls= in hyprland.conf
   #+begin_src bash
    decoration {
        blurls = emacs
    }
   #+end_src
5. Add opacity and designated workspace in =window-rules.conf= to emacs
   #+begin_src
   windowrulev2 = opacity 0.97,class:^(emacs)$
   windowrulev2 = workspace 4, class:^(emacs)$
   #+end_src
6. Add emacs daemon to =autostart.conf=
   #+begin_src bash
    exec-once=emacs --daemon
   #+end_src
7. Add emacs client to autostart in =autolaunch= script
   #+begin_src
     hyprctl keyword windowrule "workspace 4 silent,emacs" && sleep 4 && hyprctl dispatch exec "emacsclient -c -a emacs"
     hyprctl keyword windowrule "unset,emacs"
   #+end_src
8. Set vars in =.zshenv=
   #+begin_src bash
    EDITOR="emacsclient -c -a emacs"
    ALTERNATE_EDITOR=""
   #+end_src
9. Add a keybinding for launching emacs client in =keybinds.conf=
   #+begin_src bash
    bind = SUPER, E, exec, pgrep 'emacs' && hyprctl dispatch focuswindow '^emacs$' || hyprctl dispatch exec 'emacsclient -c -a emacs'
   #+end_src

** Mime types
Org mode isn't recognised as it's own mime type by default, but that can easily be changed with the following file. For system-wide changes try ~/usr/share/mime/packages/org.xml~.

#+begin_src xml
<mime-info xmlns='http://www.freedesktop.org/standards/shared-mime-info'>
  <mime-type type="text/org">
    <comment>Emacs Org-mode File</comment>
    <glob pattern="*.org"/>
    <alias type="text/org"/>
  </mime-type>
</mime-info>
#+end_src
What's nice is that Papirus [[https://github.com/PapirusDevelopmentTeam/papirus-icon-theme/commit/a10fb7f2423d5e30b9c4477416ccdc93c4f3849d][now]] has an icon for =text/org=. One simply needs to refresh their mime database
#+begin_src shell
update-mime-database ~/config/.local/share/mime
#+end_src
Then set Emacs as the default editor
#+begin_src shell
xdg-mime default emacs.desktop text/org
#+end_src

** Git diffs
Protesilaos wrote a [[https://protesilaos.com/codelog/2021-01-26-git-diff-hunk-elisp-org/][very helpful article]] in which he explains how to change the git diff chunk heading to something more useful than just the immediate line above the hunk --- like the parent heading.

This can be achieved by first adding a new diff mode to git in =~/.config/git/attributes=
#+begin_src fundamental
,*.org   diff=org
#+end_src

Then adding a regex for it to =~/.config/git/config=
#+begin_src gitconfig
[diff "org"]
  xfuncname = "^(\\*+ +.*)$"
#+end_src
** Literate programming
1. =<s *TAB*=
2. define which file should be it tangled
   in the beginning
   - =+property header-args :tangle config.el=
   or with the code block
   - =#+begin_src xml :tangle ~/.local/share/mime/packages/org.xml :mkdirp yes :comments no=
3. Go to the beginning of the line and press: =C-c C-c=
4. If tangled file hasn't been created use: =org-babel-tangle=
