# interact with the SMTP server
telnet 10.129.14.128 25

# the actual initialization of the session is done with the command HELO or EHLO
HELO mail1.inlanefreight.htb

# the command VRFY can be used to enumerate existing users on the system. 
# However, this does not always work. Depending on how the SMTP server 
# is configured, the SMTP server may issue code 252 and confirm the existence 
# of a user that does not exist on the system.
VRFY root

# footprinting
# ls /usr/share/nmap/scripts | rg smtp
sudo nmap 10.129.14.128 -sC -sV -p25

# this script uses the EHLO command to list all possible commands that can be executed on the target SMTP server
sudo nmap -p25 --script smtp-commands 10.129.42.195
# if VRFY command is available you can attempt to enumerate users on the system
sudo nmap -p25 --script smtp-enum-users --script-args smtp-enum-users.methods={VRFY} 10.129.42.195

# enumerate users using different footprinting wordlist
smtp-user-enum -M VRFY -U footprinting-wordlist.txt -t 10.129.113.87 -v -p 25 -w 20 -m 60
# or try using nmap
sudo nmap -p25 --script smtp-enum-users --script-args smtp-enum-users.methods={VRFY},smtp-enum-users.userdb=~/playground/footprinting-wordlist.txt 10.129.42.195 -v

# identify the target SMTP server as an open relay using 16 different tests
# If we also print out the output of the scan in detail, we will also be able to see which tests the script is running
sudo nmap -p25 --script smtp-open-relay 10.129.42.195 -v

