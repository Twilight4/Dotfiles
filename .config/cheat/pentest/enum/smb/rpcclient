# Connect through RPClient (anonymous user without password)
rpcclient -U "" 10.129.14.128

# Requests for enumeration
srvinfo 	                # Server information
enumdomains 	            # Enumerate all domains that are deployed in the network
querydominfo 	            # Provides domain, server, and user information of deployed domains
netshareenumall           # Enumerates all available shares
netsharegetinfo <share> 	# Provides information about a specific share
enumdomusers 	            # Enumerates all domain users
queryuser <RID> 	        # Provides information about a specific user

# User enumeration
enumdomusers
queryuser 0x3e9
queryuser 0x3e8

# Group Information - we can use the results to identify the group's RID, which we can then use to retrieve information from the entire group
querygroup 0x201

# Brute Forcing User RIDs (exit the rpcclient)
for i in $(seq 500 1100);do rpcclient -N -U "" <TARGET_IP> -c "queryuser 0x$(printf '%x\n' $i)" | grep "User Name\|user_rid\|group_rid" && echo "";done
# Alternative script from Impacket - sarmdump.py https://github.com/fortra/impacket/blob/master/examples/samrdump.py
samrdump.py 10.129.14.128
