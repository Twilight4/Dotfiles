# Remote Desktop Protocol (RDP) - 3389 port
# RDP is a protocol developed by Microsoft for remote access to a computer running the Windows operating system. This protocol allows
# display and control commands to be transmitted via the GUI encrypted over IP networks. Remote Desktop can be activated using the 
# Server Manager and comes with the default setting to allow connections to the service only to hosts with Network level authentication (NLA).

# Footprinting - Relevant information: NLA is enabled on the server or not, product version, hostname
nmap -sV -sC 10.129.201.248 -p3389 --script rdp*
# We can see that the RDP cookies (mstshash=nmap) used by Nmap to interact with the RDP server can be
# identified by threat hunters and various security services such as Endpoint Detection and Response (EDR)
# and can lock us out as penetration testers on hardened networks.
nmap -sV -sC 10.129.201.248 -p3389 --packet-trace --disable-arp-ping -n

# RDP Security Check can unauthentically identify the security settings of RDP servers based on the handshakes
./rdp-sec-check.pl 10.129.201.248

# We can connect to RDP servers on Linux using xfreerdp, rdesktop, or Remmina and interact with the GUI of the server accordingly.
# Initiate an RDP Session 
xfreerdp /u:cry0l1t3 /p:"P455w0rd!" /v:10.129.201.248

# Brute force credentials for RDP
sudo hydra -L usernames.txt -P passwords.txt -F rdp://10.0.2.5 -V
# or
sudo hydra -L usernames.txt -P passwords.txt -F rdp://10.0.2.5 -V
